<!doctype html>
<html>
﻿
<!-- Mirrored from www.ev3dev.org/docs/drivers/lego-sensor-class/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 01 Jun 2015 09:06:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>LEGO Sensor Class</title>
    <link rel="alternate" type="application/atom+xml" href="../../../news/atom.xml" title="Atom feed">
    <link rel="stylesheet" href="../../../stylesheets/styles.css">
    <link rel="stylesheet" href="../../../stylesheets/pygment_trac.css">
    <script src="../../../../ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="../../../javascripts/jquery.getUrlParam.js"></script>
    <script src="../../../javascripts/jquery.loadTemplate-1.4.4.min.js"></script>
    <script src="../../../javascripts/respond.js"></script>
    <script src="../../../javascripts/cards.js"></script>
    <script src="../../../javascripts/menu.js"></script>
    <script src="../../../javascripts/search.js"></script>
    <script src="../../../javascripts/tabs.js"></script>
    <script src="../../../javascripts/ua-parser.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <script type="text/html" id="search-result-template">
        <div class="search-result">
            <a data-href="href"><h4 data-content="title"></h4></a>
            <span data-content="breadcrumbs" class="search-result-breadcrumbs"></span>
            <span data-content="author" class="search-result-author"></span><br/>
            <span data-content="date" class="search-result-date"></span>
        </div>
    </script>

</head>

<body>
    <div id="header" class="mobile-hidden">
    <nav>
        <li class="nav-menu">
            <img src="../../../images/menu.png" />
        </li>

        <li class="left button">
            <a href="../../../index.html" title="There's no place like Home...">Home</a>
        </li>
        <li class="left button">
            <a href="../../index.html" title="Documentation on how to use ev3dev">Docs</a>
        </li>
        <li class="left button">
            <a href="../../../news/index.html" title="News about ev3dev">News</a>
        </li>
        <li class="left button dropdown-button">
            <a>
                Community
                <div class="nav-dropdown-arrow">
                    
                </div>
            </a>
            <ul class="button-dropdown">
                <li>
                    <a href="../../../share/index.html" title="Discover and share projects that use ev3dev">Share</a>
                </li>
                <li>
                    <a href="../../../contribute/index.html" title="How to contribute to ev3dev">Contribute</a>
                </li>
                <li>
                    <a href="../../../support/index.html" title="Found a bug? Have a question?">Get Help</a>
                </li>
            </ul>
        </li>
        <li class="left button">
            <a href="https://github.com/ev3dev/ev3dev/releases" title="SD card image files">Download</a>
        </li>
        <!-- items below float right, so appear in reverse order -->
        <li class="right header-box" id="search-li">
            <input type="text" id="search-input" onfocus="searchFocus()" onkeyup="searchTextChanged()" placeholder="Quick Nav" onkeypress="this.onkeyup();" onpaste="this.onkeyup();" oninput="this.onkeyup();" />
            <div id="search-dropdown">
                <div class="search-results-container" id="search-results-docs">
                    <h2>In docs</h2>
                    <div data-content="docs-results">
                        <div class="no-results-note">No results</div>
                    </div>
                </div>

                <div class="search-results-container" id="search-results-projects">
                    <h2>In projects</h2>
                    <div data-content="project-results">
                        <div class="no-results-note">No results</div>
                    </div>
                </div>

                <div class="search-results-container" id="search-results-news">
                    <h2>In news</h2>
                    <div data-content="news-results">
                        <div class="no-results-note">No results</div>
                    </div>
                </div>

                <div class="search-results-container" id="search-results-misc">
                    <h2>In other pages</h2>
                    <div data-content="misc-results">
                        <div class="no-results-note">No results</div>
                    </div>
                </div>
            </div>
        </li>
    </nav>
</div>

<!-- make sure this get included on every page -->
<!--[if !IE]><script>fixScale(document);</script><![endif]-->

    <div class="wrapper">
        <section>
            <div id="title">
    <div id="logoContainer">
        <a href="../../../index.html">
            <img id="logo" src="../../../../avatars3.githubusercontent.com/u/6878323782c.png?s=140" />
        </a>
        <div id="titleHeader" class="clear">
            <h1 id="pageTitle">LEGO Sensor Class</h1>
            <p id="pageSubtitle"></p>
        </div>
    </div>
    <hr class="clear">
</div>


            <div id="mainContent">
                
    
    

<div class="edit-on-github">
<a href="https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fev3dev%2Flego-linux-drivers%2Fedit%2Fmaster%2Fsensors%2Flego_sensor_class.c">Edit on Github</a>
</div>
<div class="breadcrumbs">
﻿


    
        
        <a href="../../index.html">docs</a> &gt;
    

    
        
        <a href="../index.html">drivers</a> &gt;
    

    
        lego-sensor-class
    


    (kernel: 3.16.7-ckt11-5-ev3dev-ev3)

</div>
<hr />

<p>The <code>lego-sensor</code> class provides a uniform interface for using most of the
sensors available for the EV3. The various underlying device drivers will
create a <code>lego-sensor</code> device for interacting with the sensors.</p>

<p>Sensors are primarily controlled by setting the <code>mode</code> and monitored by
reading the <code>value&lt;N&gt;</code> attributes. Values can be converted to floating point
if needed by <code>value&lt;N&gt;</code> / 10.0 ^ <code>decimals</code>.</p>

<h3 id="identifying-sensors">Identifying sensors</h3>

<p>Since the name of the <code>sensor&lt;N&gt;</code> device node does not correspond to the port
that a sensor is plugged in to, you must look at the <code>port_name</code> attribute if
you need to know which port a sensor is plugged in to. However, if you don’t
have more than one sensor of each type, you can just look for a matching
<code>driver_name</code>. Then it will not matter which port a sensor is plugged in to - your
program will still work.</p>

<h3 id="sysfs-attributes">sysfs Attributes</h3>

<p>Sensors can be found at <code>/sys/class/lego-sensor/sensor&lt;N&gt;</code>, where <code>&lt;N&gt;</code> is
incremented each time a sensor is loaded (it is not related to which port
the sensor is plugged in to).</p>

<dl>
  <dt><code>bin_data</code> (read-only)</dt>
  <dd>Reading the file will give the unscaled raw values in the <code>value&lt;N&gt;</code>
attributes. Use <code>bin_data_format</code>, <code>num_values</code> and the individual sensor
documentation to determine how to interpret the data.</dd>
  <dt><code>bin_data_format</code> (read-only)</dt>
  <dd>Returns the format of the values in <code>bin_data</code> for the current mode.
Possible values are:

    <ul>
      <li><code>u8</code>: Unsigned 8-bit integer (byte)</li>
      <li><code>s8</code>: Signed 8-bit integer (sbyte)</li>
      <li><code>u16</code>: Unsigned 16-bit integer (ushort)</li>
      <li><code>s16</code>: Signed 16-bit integer (short)</li>
      <li><code>s16_be</code>: Signed 16-bit integer, big endian</li>
      <li><code>s32</code>: Signed 32-bit integer (int)</li>
      <li><code>float</code>: IEEE 754 32-bit floating point (float)</li>
    </ul>
  </dd>
  <dt><code>command</code> (write-only)</dt>
  <dd>Sends a command to the sensor.</dd>
  <dt><code>commands</code> (read-only)</dt>
  <dd>Returns a space separated list of the valid commands for the sensor.
Returns -EOPNOTSUPP if no commands are supported.</dd>
  <dt><code>direct</code> (read/write)</dt>
  <dd>Allows direct communication with the sensor for using advanced features
that are not otherwise available through the lego-sensor class. Returns
<code>-EOPNOTSUPP</code> if the sensor does not support this. Currently this only
works with I2C sensors. For I2C sensors, use <code>seek</code> to set the register
to read or write from, then read or write the number of bytes required.</dd>
  <dt><code>decimals</code> (read-only)</dt>
  <dd>Returns the number of decimal places for the values in the <code>value&lt;N&gt;</code>
attributes of the current mode.</dd>
  <dt><code>driver_name</code> (read-only)</dt>
  <dd>Returns the name of the sensor device/driver. See the list of <a href="../../sensors/index.html#supported-sensors">supported
sensors</a> for a complete list of drivers.</dd>
  <dt><code>fw_version</code> (read-only)</dt>
  <dd>Returns the firmware version of the sensor if available. Currently only
NXT/I2C sensors support this.</dd>
  <dt><code>mode</code> (read/write)</dt>
  <dd>Returns the current mode. Writing one of the values returned by <code>modes</code>
sets the sensor to that mode.</dd>
  <dt><code>modes</code> (read-only)</dt>
  <dd>Returns a space separated list of the valid modes for the sensor.</dd>
  <dt><code>num_values</code> (read-only)</dt>
  <dd>Returns the number of <code>value&lt;N&gt;</code> attributes that will return a valid value
for the current mode.</dd>
  <dt><code>poll_ms</code> (read/write)</dt>
  <dd>Returns the polling period of the sensor in milliseconds. Writing sets the
polling period. Setting to 0 disables polling. Minimum value is hard
coded as 50 msec. Returns -EOPNOTSUPP if changing polling is not supported.
Currently only NXT/I2C sensors support changing the polling period.</dd>
  <dt><code>port_name</code> (read-only)</dt>
  <dd>Returns the name of the port that the sensor is connected to, e.g. <code>in1</code>.
I2C sensors also include the I2C address (decimal), e.g. <code>in1:i2c8</code>.</dd>
  <dt><code>units</code> (read-only)</dt>
  <dd>Returns the units of the measured value for the current mode. May return
empty string”</dd>
  <dt><code>value&lt;N&gt;</code> (read-only)</dt>
  <dd>Returns the value or values measured by the sensor. Check <code>num_values</code> to
see how many values there are. Values with N &gt;= num_values will return an
error. The values are fixed point numbers, so check <code>decimals</code> to see if
you need to divide to get the actual value.</dd>
</dl>

<h3 id="events">Events</h3>

<p>In addition to the usual “add” and “remove” events, the kernel “change”
event is emitted when <code>mode</code> or <code>poll_ms</code> is changed. The <code>value&lt;N&gt;</code>
attributes change too rapidly to be handled this way and therefore do not
trigger any uevents.</p>


            </div>
        </section>
        <div id="footer">
    <hr class="clear">
    <div class="cclicense">

        <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">
            www.ev3dev.org (with the exception of the projects pages)
        </span>
        is licensed under
        <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
            <img alt="Creative Commons License" style="border-width:0" src="../../../../licensebuttons.net/l/by-sa/4.0/80x15.png" />
        </a>.
        <br />
        You are free to copy the text and images, but please be courteous and acknowledge the source.

    </div>
    <br />
    <hr class="clear">
    <span class="credits left">
        Project maintained by <a href="https://github.com/rhempel">Ralph Hempel</a>
        and <a href="https://github.com/dlech">David Lechner</a>, with help from the community
    </span>
    <span class="credits right">
        Hosted on GitHub Pages <!--&mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a>-->
    </span>
</div>

    </div>
</body>

<!-- Mirrored from www.ev3dev.org/docs/drivers/lego-sensor-class/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 01 Jun 2015 09:06:27 GMT -->
</html>
